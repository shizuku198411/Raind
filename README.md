# Raind - Zero Trust Oriented Container Runtime
<p>
  <img src="assets/raind_icon.png" alt="Project Icon" width="190">
</p>

**Raind** は **Zero Trust コンテナ** をコンセプトに設計された、実験的なコンテナランタイムです。  
従来の「ネットワークは外部で守る」という前提ではなく、**ランタイム自身が通信を制御・観測するセキュリティ境界になる** ことを目指しています。

本プロジェクトは「実用的な代替ランタイム」を目指すものではなく、

> コンテナランタイム自身がセキュリティ境界になり得るか

という設計思想に基づくPoCです。

## 問題意識
多くのコンテナ環境では、以下が暗黙の前提になっています。

- コンテナ間通信は基本的に自由 (flat network)
- ネットワークセキュリティは上位 (FW / Service Mesh / CNI) に委ねる
- ランタイムは「起動と隔離」までが責務

しかしこの前提では、

- **どのコンテナが、どこへ通信したか** をランタイム単位で把握できない
- 通信ログとコンテナ実体の突合が困難 (SNATによるコンテナアドレスの隠蔽)
- 「許可されている通信」と「偶然通っている通信」の区別が曖昧

という問題が残ります。  
Raindはこれらを **ランタイムレイヤで解決できるか** を検証します。

## 設計思想
### 1. Zero Trustは「デフォルトで拒否」から始まる
Raindでは以下を前提にします。

- コンテナは **互いに信頼しない**
- 通信は **明示的なポリシーでのみ許可**
- 暗黙の許可は存在しない

この思想は特に **East-West (コンテナ間通信)** に強く反映しています。

### 2. ランタイム自身を通信の強制ポイントにする
Raindは以下を重視しています。

- 通信制御を「外部コンポーネント」に一任しない
- ランタイム自身が
    - 通信を止められる
    - 通信を観測できる
    - 判定理由をログに残せる

ポイントは、**「通信が必ず通過するポイントをランタイムが握る」** ことです。

### 3. 観測(Observe)と強制(Enforce)を分離する
RaindはNorth-South(外部通信)に対して、

- **Observe** (全許可・ログのみ)
- **Enforce** (ポリシー未定義は拒否)

を切り替え可能にしています。これは、

- いきなり遮断しない
- 実トラフィックを見ながらポリシーを設計する

という実運用を意識した設計思想です。

## ネットワークモデル
### East-West (コンテナ間通信)
- デフォルト: **Deny**
- 方向性を持った明示ポリシーによってのみAllow

### North-South (外部通信)
- デフォルト: **Observeモード**
- Enforceモードへの切り替えが可能

### ポリシーは「コンテナ起点」で定義可能
ポリシーはアドレス起点ではなく、「コンテナ起点」で定義が可能  
例: 送信元コンテナ: Web、宛先コンテナ: DB、プロトコル：TCP/3306、アクション: Allow

## ログ設計
Raindは通信ログを **ランタイムの一次成果** として扱います。
### ログの特徴
- 5-tuple (src/dst IP, src/dst port, protocol)
- コンテナID / コンテナ名 / veth
- East-West / North-Southの区別
- Allow /Deny
- 適用されたポリシーID

ログは単なるデバッグ用途ではなく、

> 「なぜその通信が許可/拒否されたか」を説明できる監査ログ

として設計しています。

## ランタイムとしての機能範囲
Raindは一般的なコンテナランタイムの機能として以下を実装しています。

- Linux Namespaceによる隔離
- cgroup v2によるリソース制限
- Capability / Seccomp / AppArmor
- Docker Hubからのイメージ取得

### OCI準拠のコンテナ起動
コンテナ起動におけるライフサイクルおよび設定ファイルは、[OCI Runtime Spec](https://github.com/opencontainers/runtime-spec/tree/main)に準拠しています。

## 位置づけ (v0.1.0)
Raind v0.1.0は以下を目的としたリリースです。

- Zero Trust を コンテナランタイムの責務として実装可能か の検証
- ネットワーク制御・観測をランタイムに統合する設計の検証
- 実運用ではなく 設計・実装・思想の PoC

### ロードマップ
- 安定性・パフォーマンス最適化
- 高度なL7ポリシー
- eBPF / nftables等への拡張
- コンテナ隔離処理のセキュリティ向上

## ドキュメント
- [Raindセットアップ](./docs/install.md)
- [Raind利用方法](./docs/usage.md)
- [デザインドキュメント](./docs/design.md)

## ステータス
- Status: Experimental / PoC (Proof of Concept)
- Version: v0.1.0
- 対象読者:
    - コンテナランタイム開発者
    - コンテナセキュリティ設計者
    - Zero Trust / ネットワーク制御に関心のあるエンジニア
